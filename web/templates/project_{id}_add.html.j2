{% macro show_samples(samples) %}
    {% for sample in samples %}
    <div class="form-check {% if sample.quantity == 0.0 %}opacity-50{% endif %}">
        <input class="form-check-input"
               type="checkbox"
               name="sample"
               value="{{sample.id}}"
               id="sample-{{sample.id}}">
        <label class="form-check-label" for="sample-{{sample.id}}">
            <span class="font-monospace">{{ sample.id | idfmt("S") }}</span>: <b>{{ sample.taxon.complete_name }}</b>
            <span class="text-body-tertiary">
            from {{ sample.source.name }}
            {% if sample.year %}
            ({{ sample.year }})
            {% endif %}
            {% if sample.notes %} - {{ sample.notes }}{% endif %}
            </span>
        </label>
    </div>
    {% endfor %}
{% endmacro %}


{% if refresh_samples %}

  {{ show_samples(samples) }}

{% else %}

{% extends "root.html.j2" %}
{% from "_macros.html.j2" import icon, breadcrumbs, filter_sort_widget %}
{% block title %}Add Samples to Project{% endblock %}
{% block content %}
{{ breadcrumbs([
{"name": "Home", "link": ("/" | app_url) },
{"name": "Projects", "link": ("/project/list" | app_url) },
{"name": project.id | idfmt("P"), "link": ("/project/" ~ project.id) | app_url },
{"name": "Add Samples", "active": true }]) }}
<h2>{{ self.title() }}</h2>
<p>Choose samples to add to the project <i>{{ project.name }}</i></p>
{{ filter_sort_widget(("/project/" ~ project.id ~ "/add") | app_url, "#sample-list", filter_spec)}}
<div id="flash-messages" class="sticky-top"></div>
{% if samples %}
<form id="project-add-form"
    hx-post="{{ ("/project/" ~ project.id ~ "/add") | app_url }}"
    hx-swap="none">
    <div id="sample-list"
    hx-trigger="reload-samples from:body"
    hx-get
    hx-swap="innerHTML"
    >
      {{ show_samples(samples) }}
    </div>
    <div class="row mb-3 sticky-bottom">
        <button type="submit" class="btn btn-primary">Add</button>
    </div>
</form>
{% else %}
<div class="alert alert-warning">No samples available to add. 
    <a href="{{ "/sample/new" | app_url }}">Add a new sample to the database first</a>.
</div>
{% endif %}
{% endblock %}
{% endif %}
